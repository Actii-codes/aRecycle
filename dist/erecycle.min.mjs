/**
* A recycle manager
* @class ERecycleSingleton
* @license ERecycle does not have a license at this time. For licensing contact the author
* @author https://github.com/doubleactii
* Copyright (c) 2023 Evitca Studio
*/
class ERecycleSingleton{static version="1.0.0";static DiobConstructor=(()=>{var e=VYLO.newDiob(),t=e.__proto__.constructor;return VYLO.delDiob(e),t})();constructor(){this.debugging=!1,this.collectionLimit=20,this.WARNING_LIMIT=200,this.basicCollection=[]}setMaxLimit(e){"number"==typeof e&&(this.collectionLimit=Math.round(e),this.collectionLimit>this.WARNING_LIMIT)&&console.warn("ERecycle: This is a high value to use for a max limit in a collection! Only use this high of a value if you know what you are doing.")}collect(t,o){var e=Array.isArray(t);if(t)if("object"!=typeof t||e||Object.keys(t).length)if(t.type||e)if(Array.isArray(o))if(o.includes(t))this.debugging&&console.error("ERecycle: OOPS! %cpCollected","font-weight: bold","already belongs to the provided collection.");else if(e&&!t.length)console.error("ERecycle: OOPS! %cpCollected","font-weight: bold","is an array. But it contains nothing to recycle.");else if(e)if(o.length>=this.collectionLimit)for(let e=t.length-1;0<=e;e--){var l=t[e];l instanceof ERecycleSingleton.DiobConstructor?(this.cleanInstance(l),VYLO.delDiob(l)):(this.cleanInstance(l),VYLO.delObject(l))}else{if(t.length+o.length>this.collectionLimit)for(let e=t.length-(this.collectionLimit-o.length);0<e;e--){var c=t[e];c instanceof ERecycleSingleton.DiobConstructor?(t.splice(e,1),this.cleanInstance(c),VYLO.delDiob(c)):(t.splice(e,1),this.cleanInstance(c),VYLO.delObject(c))}for(let e=t.length-1;0<=e;e--){var n=t[e];"function"==typeof n.onCollected&&n.onCollected(),o.includes(n)||o.push(n),this.cleanInstance(n)}}else o.length>=this.collectionLimit?t instanceof ERecycleSingleton.DiobConstructor?(this.cleanInstance(t),VYLO.delDiob(t)):(this.cleanInstance(t),VYLO.delObject(t)):("function"==typeof t.onCollected&&t.onCollected(),o.includes(t)||o.push(t),this.cleanInstance(t));else console.error("ERecycle: Invalid variable type passed for the %cpCollection","font-weight: bold","parameter. Expecting an array. Collect failed.");else console.error("ERecycle: OOPS! %cpCollected","font-weight: bold"," is not a valid object It has no type.");else console.error("ERecycle: OOPS! %cpCollected","font-weight: bold"," is an empty object and will NOT be collected.");else console.error("ERecycle: There was nothing passed for the %cpCollected","font-weight: bold","parameter. Expecting a instance or an object.")}isInCollection(t="Diob",o=1,l=[],...c){var n=[];let i=0,s=o;var r,a=!VYLO.Type.getVariable(t,"baseType");if(l.length){for(let e=l.length-1;0<=e;e--)s&&(r=l[e]).type===t&&(l.splice(e,1),n.push(r),r.ERecycleCollected=!1,"function"==typeof r.onDumped&&r.onDumped(...c),i++,s--);if(o>i){var h=o-i;for(let e=0;e<h;e++)n.push(a?VYLO.newObject(t,...c):VYLO.newDiob(t,...c))}}else for(let e=0;e<o;e++)n.push(a?VYLO.newObject(t,...c):VYLO.newDiob(t,...c));return 1===n.length?n.pop():n}cleanInstance(e){if(e){if(e instanceof ERecycleSingleton.DiobConstructor){var t="Interface"===e.baseType||"Interface"===e.type||VYLO.Type.getInheritances(e.type).includes("Interface");e.color&&("object"==typeof e.color&&e.color.constructor===Object?(e.color.tint=16777215,e.color=e.color):e.color=null),"object"==typeof e.scale?(e.scale.x=e.scale.y=1,e.scale=e.scale):e.scale=1,t&&(e.hide(),"server"!==VYLO.World.getCodeType())&&VYLO.Client.removeInterfaceElement(e.getInterfaceName(),e,!0),e.playAnimation(),e.setTransition(),e.angle=0,e.alpha=1,e.xPos=0,e.yPos=0,t||(e.mapName=null,e.setLoc()),e.text="",e.composite="","Movable"===e.baseType&&e.move();for(const o of e.getOverlays())e.removeOverlay(o.type);for(const l of e.getFilters())e.removeFilter(l)}e.ERecycleCollected=!0,e.inTicker=null,"function"==typeof e.clean&&e.clean()}}toggleDebug(){this.debugging=!this.debugging}}const ERecycle=new ERecycleSingleton;export{ERecycle};