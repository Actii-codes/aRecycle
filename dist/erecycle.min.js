/**
* A recycle manager
* @class ERecycleSingleton
* @license ERecycle does not have a license at this time. For licensing contact the author
* @author https://github.com/doubleactii
* Copyright (c) 2023 Evitca Studio
*/ class ERecycleSingleton{static version="1.0.0";static DiobConstructor=(()=>{let e=VYLO.newDiob(),t=e.__proto__.constructor;return VYLO.delDiob(e),t})();constructor(){this.debugging=!1,this.collectionLimit=20,this.WARNING_LIMIT=200,this.basicCollection=[]}setMaxLimit(e){"number"==typeof e&&(this.collectionLimit=Math.round(e),this.collectionLimit>this.WARNING_LIMIT&&console.warn("ERecycle: This is a high value to use for a max limit in a collection! Only use this high of a value if you know what you are doing."))}collect(e,t){let l=Array.isArray(e);if(!e){console.error("ERecycle: There was nothing passed for the %cpCollected","font-weight: bold","parameter. Expecting a instance or an object.");return}if("object"==typeof e&&!l&&!Object.keys(e).length){console.error("ERecycle: OOPS! %cpCollected","font-weight: bold"," is an empty object and will NOT be collected.");return}if(!e.type&&!l){console.error("ERecycle: OOPS! %cpCollected","font-weight: bold"," is not a valid object It has no type.");return}if(Array.isArray(t)){if(t.includes(e)){this.debugging&&console.error("ERecycle: OOPS! %cpCollected","font-weight: bold","already belongs to the provided collection.");return}if(l&&!e.length){console.error("ERecycle: OOPS! %cpCollected","font-weight: bold","is an array. But it contains nothing to recycle.");return}if(l){if(t.length>=this.collectionLimit){for(let o=e.length-1;o>=0;o--){let n=e[o];n instanceof ERecycleSingleton.DiobConstructor?(this.cleanInstance(n),VYLO.delDiob(n)):(this.cleanInstance(n),VYLO.delObject(n))}return}if(e.length+t.length>this.collectionLimit){let c=e.length-(this.collectionLimit-t.length);for(let i=c;i>0;i--){let r=e[i];r instanceof ERecycleSingleton.DiobConstructor?(e.splice(i,1),this.cleanInstance(r),VYLO.delDiob(r)):(e.splice(i,1),this.cleanInstance(r),VYLO.delObject(r))}}for(let s=e.length-1;s>=0;s--){let a=e[s];"function"==typeof a.onCollected&&a.onCollected(),t.includes(a)||t.push(a),this.cleanInstance(a)}return}if(t.length>=this.collectionLimit){e instanceof ERecycleSingleton.DiobConstructor?(this.cleanInstance(e),VYLO.delDiob(e)):(this.cleanInstance(e),VYLO.delObject(e));return}"function"==typeof e.onCollected&&e.onCollected(),t.includes(e)||t.push(e),this.cleanInstance(e);return}console.error("ERecycle: Invalid variable type passed for the %cpCollection","font-weight: bold","parameter. Expecting an array. Collect failed.")}isInCollection(e="Diob",t=1,l=[],...o){let n=[],c=0,i=t,r=!VYLO.Type.getVariable(e,"baseType");if(l.length){for(let s=l.length-1;s>=0;s--)if(i){let a=l[s];a.type===e&&(l.splice(s,1),n.push(a),a.ERecycleCollected=!1,"function"==typeof a.onDumped&&a.onDumped(...o),c++,i--)}if(t>c){let h=t-c;for(let f=0;f<h;f++)r?n.push(VYLO.newObject(e,...o)):n.push(VYLO.newDiob(e,...o))}return 1===n.length?n.pop():n}for(let g=0;g<t;g++)r?n.push(VYLO.newObject(e,...o)):n.push(VYLO.newDiob(e,...o));return 1===n.length?n.pop():n}cleanInstance(e){if(e){if(e instanceof ERecycleSingleton.DiobConstructor){let t="Interface"===e.baseType||"Interface"===e.type||VYLO.Type.getInheritances(e.type).includes("Interface");for(let l of(e.color&&("object"==typeof e.color&&e.color.constructor===Object?(e.color.tint=16777215,e.color=e.color):e.color=null),"object"==typeof e.scale?(e.scale.x=e.scale.y=1,e.scale=e.scale):e.scale=1,t&&(e.hide(),"server"!==VYLO.World.getCodeType()&&VYLO.Client.removeInterfaceElement(e.getInterfaceName(),e,!0)),e.playAnimation(),e.setTransition(),e.angle=0,e.alpha=1,e.xPos=0,e.yPos=0,t||(e.mapName=null,e.setLoc()),e.text="",e.composite="","Movable"===e.baseType&&e.move(),e.getOverlays()))e.removeOverlay(l.type);for(let o of e.getFilters())e.removeFilter(o)}e.ERecycleCollected=!0,e.inTicker=null,"function"==typeof e.clean&&e.clean()}}toggleDebug(){this.debugging=!this.debugging}}console.log("%cERecycle.js: âœ… ERecycle.js@"+ERecycleSingleton.version,"font-family:arial;");export const ERecycle=new ERecycleSingleton;